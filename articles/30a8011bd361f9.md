---
title: "Matplotlibã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œã®å›³ã‚’ã„ã„æ„Ÿã˜ã«ä½œã‚‹"
emoji: "ğŸ’¡"
type: "tech"
topics: ["python", "matplotlib", "darkmode"]
published: true
---

Matplotlibã®è¡¨ç¤ºè¦ç´ ã«ç™½è‰²ã®ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€åŒä¸€ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆç™½èƒŒæ™¯ï¼‰ã¨ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé»’èƒŒæ™¯ï¼‰ã®ä¸¡æ–¹ã§è¦‹ã‚„ã™ã„è¡¨ç¤ºã¨ãªã‚‹ä½œå›³æ–¹æ³•ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚ä»¥ä¸‹ã®ä¾‹ã®ã‚ˆã†ã«ã€å›³ã®èƒŒæ™¯ã‚’é€æ˜ã«ã—ã¦ã‚‚ç·šã‚„ãƒ†ã‚­ã‚¹ãƒˆãŒé»’èƒŒæ™¯ã«åŸ‹ã‚‚ã‚Œãšã€ãã“ãã“è¦‹ã‚„ã™ã„å½¢ã§ä¸¡ç«‹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

![darkmode-compatible-figure-light.png][light] | ![darkmode-compatible-figure-dark.png][dark]
:---: | :---:
ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆç™½èƒŒæ™¯ï¼‰ã§ã®è¡¨ç¤º | ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼ˆé»’èƒŒæ™¯ï¼‰ã§ã®è¡¨ç¤º

[light]: /images/darkmode-compatible-figure-light.png
[dark]: /images/darkmode-compatible-figure-dark.png

:::message
Zennã®åˆ¶é™ã«ã‚ˆã‚ŠHTMLã‚’ä½¿ã£ã¦èƒŒæ™¯è‰²ã‚’å¤‰ãˆã‚‰ã‚Œãªã„ãŸã‚ã€ä¸Šã®ä¾‹ã¯ç”»åƒè‡ªä½“ã«é»’èƒŒæ™¯ã‚’æç”»ã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã«èƒŒæ™¯è‰²ã«å¿œã˜ã¦è¡¨ç¤ºãŒå¤‰ã‚ã‚‹æ§˜å­ã¯[ã“ã¡ã‚‰](https://astropengu.in/posts/35)ã‚’ã”è¦§ãã ã•ã„ã€‚
:::

## Path effects

è¡¨ç¤ºè¦ç´ ï¼ˆartistsï¼‰ã«ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã«ã¯path effectsï¼ˆ`matplotlib.patheffects`ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚åå‰ã‹ã‚‰åˆ†ã‹ã‚‹ã‚ˆã†ã«ã€ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã§ãã‚‹ã®ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ©ã‚¤ãƒ³ãƒ—ãƒ­ãƒƒãƒˆãªã©ç·šï¼ˆãƒ‘ã‚¹ï¼‰ã‚’æŒã¤è¦ç´ ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚ä»Šå›ã®å ´åˆã€`withStroke()`ã§ãƒœãƒ¼ãƒ€ãƒ¼ã®ç·šã®è‰²ã¨ç·šå¹…ã‚’è¨­å®šã—ãŸpath effectã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

```python:è¦ç´ ã«ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹è¨­å®š
import matplotlib as plt
from matplotlib.patheffects import withStroke


border = withStroke(linewidth=3, foreground="white")
```

## Examples

ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ä½œæˆã—ãŸpath effectã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ï¼ˆ1ï¼‰rcParamsã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«è¨­å®šã™ã‚‹ã‹ã€ï¼ˆ2ï¼‰ãƒ—ãƒ­ãƒƒãƒˆé–¢é€£ã®é–¢æ•°ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ãŒæŒã¤`path_effects`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å€‹åˆ¥ã«è¨­å®šã™ã‚‹ã‹ã€ï¼ˆ3ï¼‰è¡¨ç¤ºè¦ç´ ãŒæŒã¤`set_path_effects()`ãƒ¡ã‚½ãƒƒãƒ‰ã§å€‹åˆ¥ã«è¨­å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã§ã¯ï¼ˆ1ï¼‰ã®ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

```python:å…¨ã¦ã®è¦ç´ ã«ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹å ´åˆ
with plt.rc_context({"path.effects": [border]}):
    plt.plot([1, 2, 1, 3], label="A")
    plt.plot([2, 1, 3, 2], label="B")
    plt.title("Darkmode-compatible figure")
    plt.legend()

plt.savefig("figure.png", transparent=True)
```

:::message
rcParamsã®"path.effects"ã¯è¤‡æ•°ã®è¨­å®šã‚’å—ã‘å–ã‚‹ãŸã‚ã€[border]ã®ã‚ˆã†ã«é…åˆ—ã§æ¸¡ã—ã¾ã™
:::

:::message
rc_context()ã‚’ä½¿ã†ã¨ã€withãƒ–ãƒ­ãƒƒã‚¯ã«æ›¸ã‹ã‚ŒãŸè¦ç´ ã®ã¿ã«ãƒœãƒ¼ãƒ€ãƒ¼ã‚’é©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™
:::

ä¸Šã®ä¾‹ã§ã¯å›³ï¼ˆç”»åƒï¼‰ã®å¤–å‘¨ã«ã‚‚ãƒœãƒ¼ãƒ€ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¦ã—ã¾ã†ãŸã‚è‹¥å¹²è¦‹ã¥ã‚‰ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å°‘ã—è¤‡é›‘ã«ãªã‚Šã¾ã™ãŒã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§å¤–å‘¨ã®ãƒœãƒ¼ãƒ€ãƒ¼ã‚’æ¶ˆã™ã“ã¨ãŒã§ãã¾ã™ã€‚

```python:å›³ã®å¤–å‘¨ã®ã¿ãƒœãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ ã—ãªã„å ´åˆï¼ˆæ¨å¥¨ï¼Ÿï¼‰
fig = plt.figure()

with plt.rc_context({"path.effects": [border]}):
    ax = fig.add_subplot()
    ax.plot([1, 2, 1, 3], label="A")
    ax.plot([2, 1, 3, 2], label="B")
    ax.set_title("Darkmode-compatible figure")
    ax.legend()

fig.savefig("figure.png", transparent=True)
```

## References

https://matplotlib.org/stable/tutorials/advanced/patheffects_guide.html

https://matplotlib.org/stable/api/patheffects_api.html#matplotlib.patheffects.withStroke
